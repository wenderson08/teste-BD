<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VEJA BAGAM</title>
  <link rel="icon" type="Fotos Colaboradores/unnamed.png" href="Fotos Colaboradores/unnamed.png">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    html {
  scroll-behavior: smooth;
}

.member-card { overflow: visible; } /* garantir que confetes saiam do card */
.member-card.birthday-today {
  animation: pulse-card 1.2s infinite;
  border: 4px solid #ffd54f !important;
  transform: translateY(-6px);
  box-shadow: 0 12px 30px rgba(255,193,7,0.16), 0 6px 18px rgba(33,134,67,0.08);
  position: relative;
  z-index: 2;
}

/* pulse */
@keyframes pulse-card {
  0% {
    box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.527);
  }
  12.5% {
    box-shadow: 0 0 30px 8px rgba(244, 67, 54, 0.616); /* vermelho */
  }
  25% {
    box-shadow: 0 0 30px 8px rgba(255, 153, 0, 0.664); /* laranja */
  }
  37.5% {
    box-shadow: 0 0 30px 8px rgba(255, 235, 59, 0.664); /* amarelo */
  }
  50% {
    box-shadow: 0 0 30px 8px rgba(76, 175, 79, 0.678); /* verde */
  }
  62.5% {
    box-shadow: 0 0 30px 8px rgba(33, 149, 243, 0.644); /* azul */
  }
  75% {
    box-shadow: 0 0 30px 8px rgba(104, 58, 183, 0.603); /* roxo */
  }
  87.5% {
    box-shadow: 0 0 30px 8px rgba(233, 30, 98, 0.623); /* rosa */
  }
  100% {
    box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.479);
  }
}

/* confete pieces */
.confetti {
  position: absolute;
  left: 0;
  top: 0;
  pointer-events: none;
  z-index: 9999;
  will-change: transform, opacity;
  display: inline-block;
  line-height: 1;
  font-size: var(--em-size, 22px);
  transform-origin: center;
  filter: drop-shadow(0 3px 6px rgba(0,0,0,0.12));
  /* anima√ß√£o mais suave, sem rota√ß√µes */
  animation: confetti-explode var(--dur, 1600ms) cubic-bezier(.0,.6,.2,0) both;
  animation-delay: var(--delay, 5ms);
  background: transparent;
  user-select: none;
  opacity: 0;
}

/* explos√£o suave de dentro para fora ‚Äî sem giro */
@keyframes confetti-explode {
  0% {
    transform: translate(0,0) scale(0.18);
    opacity: 0;
  }
  12% {
    transform: translate(calc(var(--dx) * 0.12), calc(var(--dy) * 0.12)) scale(1.04);
    opacity: 1;
  }
  35% {
    transform: translate(calc(var(--dx) * 0.45), calc(var(--dy) * 0.45)) scale(1.00);
    opacity: 1;
  }
  70% {
    transform: translate(calc(var(--dx) * 0.85), calc(var(--dy) * 0.85)) scale(0.98);
    opacity: 0.75;
  }
  100% {
    transform: translate(var(--dx), var(--dy)) scale(0.96);
    opacity: 0;
  }
}
.calendar-day.today {
  border: 3px solid #dd4a06 !important;
  box-shadow: 0 0 16px 2px #dd4a06, 0 0 0 px #dd4a06 inset;
  animation: pulse-today 1.2s infinite alternate;
  position: relative;
}

.calendar-day.conflict-event {
      /* Metade feriado, metade anivers√°rio */
      background: linear-gradient(
        to right,
        var(--holiday-bg) 0 50%,
        #fff7c1 50% 100%
      ) !important;
      border: 2px solid var(--holiday-border); /* Nacional */
      color: var(--holiday-txt);
      position: relative;
    }
    .calendar-day.conflict-event.local-holiday{
      /* Metade municipal, metade anivers√°rio */
      background: linear-gradient(
        to right,
        #1976d2 0 50%,
        #ef6c00 50% 100%
      ) !important;
      border: 2px solid #89b3dd; /* Municipal */
      color: #fff;
    }
    .calendar-day.conflict-event .fa-birthday-cake {
      position: absolute;
      left: 7px;
      top: 7px;
      font-size: 1.1em;
      color: #ef6c00;
      z-index: 2;
    }
    .calendar-day.conflict-event .fa-calendar-day,
    .calendar-day.conflict-event .fa-holiday {
      position: absolute;
      right: 7px;
      top: 7px;
      font-size: 1.1em;
      color: inherit;
      z-index: 2;
    }

.conflict {
  color:var(--conflict-txt)!important;font-weight:bold;background:var(--conflict-bg)!important;
  padding:7px 13px;border-radius:6px;font-size:1.08rem;margin-bottom:7px;border:2px solid #d81c1c;
  box-shadow:0 1px 8px #ffebee;display:flex;align-items:center;gap:8px;text-align:center;justify-content:center;width:95%;
}
.conflict-sector {
  color:#856404!important;background:#ffefc7!important;border-color:#ffc107!important;font-weight:bold;
  padding:7px 13px;border-radius:6px;font-size:1.08rem;margin-bottom:7px;border:2px solid #ffc107;
  box-shadow:0 1px 8px #fffbe6;display:flex;align-items:center;gap:8px;text-align:center;justify-content:center;width:95%;
}
    .calendar-day.local-holiday {
    background: #1976d2 !important;
    color: #fff !important;
    border: 2px solid #89b3dd !important;
    font-weight: bold;
    box-shadow: 0 2px 10px #90caf9;
  }
  .calendar-day.local-holiday::after {
    content: "\f133";
    font-family: "Font Awesome 6 Free";
    font-weight: 900;
    position: absolute;
    right: 7px;
    top: 7px;
    font-size: 1.1em;
    color: #fff;
  }
    :root {
      --primary: #03642c; --secondary: #047562; --accent: #38d397;
      --card-bg: #fff; --card-radius: 16px; --shadow: 0 6px 24px rgba(0, 0, 0, 0.377);
      --header-font: 'Montserrat', 'Poppins', sans-serif; --body-font: 'Poppins', sans-serif;
      --border: 1px solid #e6e6e6; --conflict-bg: #ffe3e3; --conflict-txt: #d81c1c;
      --holiday-bg: #ffd6d6; --holiday-border: #d81c1c; --holiday-txt: #b30000;
      --tooltip-bg: #218355; --tooltip-txt: #fff; --tooltip-radius: 8px;
    }
    body {
      font-family: var(--body-font);
      /* background:linear-gradient(135deg,var(--primary),var(--secondary)); */
      background-image: url('https://i.postimg.cc/fLLNZ3w1/Whats-App-Image-2025-08-21-at-18-08-59.jpg');
      background-size: cover;
      background-position: center center;
      background-repeat: no-repeat;
      background-attachment: fixed;
      margin:0;
      padding:0;
      color:#202a25;
      position: relative;
    }
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      background: rgba(33, 134, 67, 0.70); /* verde transl√∫cido, ajuste o alpha se quiser */
      pointer-events: none;
      z-index: 0;
    }
    .container, header.topbar, .calendar-container, section, footer {
      position: relative;
      z-index: 1;
    }
    h1 {font-family:var(--header-font);font-size:2.8rem;font-weight:900;letter-spacing:.5px;margin:28px 0 24px 0;border-bottom:4px solid var(--accent);padding-bottom:6px;color:#ffffff;text-align:center;}
    h2 {font-family:var(--header-font);font-weight:700;font-size:1.6rem;margin:28px 0 16px 0;color:var(--accent);}
    .filters {display:flex;gap:30px;margin:24px 0 30px 0;flex-wrap:wrap;background:rgba(255,255,255,.22);border-radius:14px;padding:18px 26px;align-items:center;border:2px solid var(--accent);justify-content:center;box-shadow:0 2px 12px rgba(33,134,67,.09);}
    .filters label {font-family:var(--header-font);font-weight:700;color:var(--primary);display:flex;align-items:center;gap:7px;font-size:1.18rem;}
    .filters select {border-radius:8px;border:2px solid var(--accent);padding:8px 18px;font-size:1.08rem;background:#f8fbf7;font-family:var(--body-font);box-shadow:0 2px 10px #38d3973d;outline:none;transition:border .2s;}
    .filters select:focus {border-color:var(--secondary);}
    .calendar-container {background:rgba(33,134,67,.95);border-radius:18px;padding:35px 28px;box-shadow:var(--shadow);margin-bottom:38px;max-width:700px;margin-left:auto;margin-right:auto;border:2px solid var(--accent);}
    .calendar-header {display:flex;justify-content:center;align-items:center;margin-bottom:18px;gap:10px;}
    .calendar-header h2 {flex:1;margin:0;color:#fff;text-align:center;}
    .calendar-grid {display:grid;grid-template-columns:repeat(7,1fr);gap:7px;text-align:center;margin-top:5px;}
    .calendar-day {padding:13px 0;border-radius:7px;background:#f8f9fa;font-weight:500;font-size:1.1rem;transition:background .2s;border:1px solid #e6e6e6;position:relative;cursor:pointer;}
    .calendar-day.header {background:var(--accent);color:#fff;font-weight:bold;font-size:1.05rem;border:none;}
    .calendar-day.birthday {background:#fff7c1;border:2px solid #ef6c00;font-weight:bold;color:#ef6c00;box-shadow:0 2px 10px #ffe9b4;}
    .calendar-day.birthday::after {content:"\f1fd";font-family:"Font Awesome 6 Free";font-weight:900;position:absolute;right:7px;top:7px;font-size:1.1em;color:#ef6c00;}
    .calendar-day.holiday {background:var(--holiday-bg);border:2px solid var(--holiday-border);color:var(--holiday-txt);font-weight:bold;box-shadow:0 2px 10px #ffd6d6;}
    .calendar-day.holiday::after {content:"\f133";font-family:"Font Awesome 6 Free";font-weight:900;position:absolute;right:7px;top:7px;font-size:1.1em;color:var(--holiday-txt);}
    .calendar-day.empty {background:transparent;border:none;box-shadow:none;}
    /* Tooltip estilizado */
    .calendar-tooltip {
      display:none;
      position:absolute;
      left:50%;
      top:-38px;
      transform:translateX(-50%);
      background:var(--tooltip-bg);
      color:var(--tooltip-txt);
      padding:7px 12px;
      border-radius:var(--tooltip-radius);
      font-size:.75rem;
      font-family:var(--body-font);
      white-space:nowrap;
      z-index:10;
      box-shadow:0 2px 8px rgba(34, 34, 34, 0.533);
      opacity:0;
      pointer-events:none;
      transition:opacity .14s,top .14s;
    }
    .calendar-day:hover .calendar-tooltip,
    .calendar-day:focus .calendar-tooltip {
      display:block;
      opacity:1;
      top:-45px;
    }
    @media (max-width:600px) {
      .calendar-tooltip {font-size:.92rem;top:-50px;}
    }
    section {
  scroll-margin-top: 90px; /* ajuste conforme altura do header */
}
    section {background:rgba(255,255,255,.11);border-radius:13px;padding:20px 14px 36px 14px;margin-bottom:32px;box-shadow:var(--shadow);border:1.5px solid var(--accent);}
    .team-container {display:flex;flex-wrap:wrap;gap:30px;justify-content:center;}
    .member-card {background:var(--card-bg);border-radius:var(--card-radius);padding:28px 18px 24px 18px;width:260px;box-shadow:0 4px 20px rgba(33,134,67,.14);margin-bottom:20px;display:flex;flex-direction:column;align-items:center;border:2.5px solid var(--accent);transition:transform .16s,box-shadow .16s;}
    .member-card:hover {transform:translateY(-7px) scale(1.04);box-shadow:0 10px 32px rgba(33,134,67,.17);border-color:#047562;}
    .member-photo {width:110px;height:110px;object-fit:cover;border-radius:50%;margin-bottom:16px;border:4px solid var(--accent);box-shadow:0 2px 14px #eefbe9;background:#eefbe9;}
    .member-card h3 {font-family:var(--header-font);font-weight:700;font-size:1.18rem;color:var(--primary);margin-bottom:6px;margin-top:2px;}
    .member-card p {font-size:1rem;margin:2px 0 7px 0;color:#303d31;font-weight:500;text-align:center;}
    .member-card .fa-plane-departure {color:#047562;margin-right:5px;}
    .member-card .fa-birthday-cake {color:#ef6c00;margin-right:5px;}
    .member-card .fa-user {color:var(--accent);font-size:1.25em;margin-bottom:5px;}
    .conflict {color:var(--conflict-txt)!important;font-weight:bold;background:var(--conflict-bg)!important;padding:7px 13px;border-radius:6px;font-size:1.08rem;margin-bottom:7px;border:2px solid #d81c1c;box-shadow:0 1px 8px #ffebee;display:flex;align-items:center;gap:8px;text-align:center;justify-content:center;width:95%;}
    .member-card .fa-exclamation-triangle {color:#d81c1c;}
    @media (max-width:700px) {.container{padding:10px;}.calendar-container{padding:18px 7px;max-width:97vw;}.team-container{flex-direction:column;align-items:center;}.member-card{width:99vw;padding:16px;}h1{font-size:2.1rem;}}
    .btn-custom {background:var(--accent);color:#fff;border:none;border-radius:6px;font-weight:600;font-size:1.1rem;padding:9px 21px;transition:background .18s;box-shadow:0 2px 10px #38d3973d;display:inline-flex;align-items:center;gap:8px;}
    .btn-custom:hover,.btn-custom:focus {background:#047562;color:#fff;outline:none;}
    header.topbar {position:fixed;top:0;left:0;width:100%;background:#fff;border-bottom:2px solid var(--accent);z-index:1000;display:flex;align-items:center;justify-content:space-between;padding:10px 32px;}
    header.topbar .logo {height:38px;margin-right:16px;}
    header.topbar nav a {margin:0 16px;color:var(--primary);font-family:var(--header-font);font-weight:600;text-decoration:none;transition:color .2s;}
    header.topbar nav a:hover {color:var(--accent);}
    .dark-mode {background:#222 !important;color:#fff;}
    .dark-mode .calendar-container, .dark-mode section {background:#333 !important;color:#fff;}
    .dark-mode h1,.dark-mode h2 {color:#38d397 !important;}
    .dark-mode .member-card {background:#222;color:#fff;}
    .dark-mode .filters {background:#2a2a2a;}
    .dark-mode .filters label {color:#38d397;}
    .dark-mode .filters select {background:#222;color:#fff;border-color:#38d397;}
    .dark-toggle {background:var(--accent);color:#fff;border:none;border-radius:50%;width:38px;height:38px;font-size:1.35rem;display:flex;align-items:center;justify-content:center;cursor:pointer;position:fixed;right:30px;bottom:30px;z-index:1100;}
    footer {text-align:center;padding:18px 0;color:#fff;background:linear-gradient(90deg,var(--primary),var(--accent));border-radius:12px;margin-top:30px;}
    
  
  </style>
</head>
<body>

  <header class="topbar">
    <div>
      <img src="https://i.postimg.cc/NG3dNtxk/Vibra-logo.png" alt="Logo" class="logo">  
    </div>
   
    <nav>
  <a href="#team-list-section"><i class="fas fa-users"></i> Colaboradores</a>
  <a href="#vacation-list-section"><i class="fas fa-plane"></i> F√©rias</a>
  <a href="#birthday-list-section"><i class="fas fa-birthday-cake"></i> Aniversariantes</a>
</nav>
    <button id="filter-btn" class="btn btn-custom" style="margin-left:18px;"><i class="fas fa-filter"></i> Filtrar</button>
<div id="filter-panel" style="display:none;position:absolute;top:60px;right:40px;z-index:2000;background:#fff;border-radius:12px;box-shadow:0 4px 18px #0002;padding:22px 28px;min-width:320px;">
  <h4 style="margin-bottom:18px;">Filtrar colaboradores</h4>
  <div style="display:flex;flex-direction:column;gap:14px;">
    <label>Setor:
      <select id="filter-setor" class="form-select">
        <option value="">Todos</option>
      </select>
    </label>
    <label>Nome:
      <input type="text" id="filter-nome" class="form-control" placeholder="Digite o nome">
    </label>
    <label>Data de anivers√°rio:
      <input type="text" id="filter-aniversario" class="form-control" placeholder="dd/mm">
    </label>
    <label>
      <input type="checkbox" id="filter-ferias"> Mostrar apenas quem est√° de f√©rias no m√™s
    </label>
    <button id="filter-aplicar" class="btn btn-success mt-2"><i class="fas fa-search"></i> Aplicar filtro</button>
    <button id="filter-fechar" class="btn btn-secondary mt-1"><i class="fas fa-times"></i> Fechar</button>
    <button id="filter-limpar" class="btn btn-outline-secondary mt-1"><i class="fas fa-undo"></i> Limpar filtro</button>
  </div>
  <div id="filter-resultado" style="margin-top:18px;"></div>
</div>
  </header>
  <div class="container" style="padding-top:80px;">
    <h1 class="text-center">VEJA BAGAM</h1>
    <div class="filters">
      <label><i class="fas fa-calendar-alt" style="color: #ffffff;"></i> M√™s: <select id="month-select"></select></label>
      <label><i class="fas fa-calendar" style="color: #ffffff;"></i> Ano: <select id="year-select"></select></label>
    </div>
    
    <!-- Legenda do calend√°rio -->
<div class="calendar-legend" style="margin-bottom:14px; display:flex; gap:20px; flex-wrap:wrap; align-items:center; justify-content: center" >
  <span style="display:flex;align-items:center;gap:7px;">
    <span style="display:inline-block; width:22px; height:22px; border-radius:7px; background:#ffd6d6; border:2px solid #d81c1c; margin-right:4px;"></span>
    <span > <h5 style="margin-top: 20px; margin-bottom: 20px; color: white;">Feriado Nacional</h5></span>
  </span>
  <span style="display:flex;align-items:center;gap:7px;">
    <span style="display:inline-block; width:22px; height:22px; border-radius:7px; background:#1976d2; border:2px solid #89b3dd; margin-right:4px;"></span>
    <span> <h5 style="margin-top: 20px; margin-bottom: 20px; color: white;">Feriado Municipal e Estadual </h5></span>
  </span>
  <span style="display:flex;align-items:center;gap:7px;">
    <span style="display:inline-block; width:22px; height:22px; border-radius:7px; background:#fff7c1; border:2px solid #ef6c00; margin-right:4px;"></span>
    <span><h5 style="margin-top: 20px; margin-bottom: 20px; color: white;">Anivers√°rio</h5></span>
  </span>
  
  </span>
</div>
    
    <div class="calendar-container">
      <div class="calendar-header">
        <button class="btn btn-custom me-2" id="prev-month"><i class="fas fa-chevron-left"></i> Anterior</button>
        <h2 id="calendar-title"></h2>
        <button class="btn btn-custom ms-2" id="next-month">Pr√≥ximo <i class="fas fa-chevron-right"></i></button>
      </div>
      <div class="calendar-grid" id="calendar-grid"></div>
    </div>
    <section id="vacation-list-section">
      <h2 style="color: #ffffff;"><i class="fas fa-plane"></i> Colaboradores de f√©rias no m√™s</h2>
      <div id="vacation-list" class="team-container"></div>
    </section>
    <section id="birthday-list-section">
     
      <h2 style="color: #ffffff;"><i class="fas fa-birthday-cake"></i> Aniversariantes do m√™s</h2>
      <div id="birthday-list" class="team-container"></div>
  
    </section>
    <section id="team-list-section">
      <h2 style="color: #ffffff;"><i class="fas fa-users"></i> Todos os colaboradores</h2>
      <div id="team-list" class="team-container"></div>
    </section>
    <section id="expiring-vacations-list-section">
      <h2 style="color: #ffffff;"><i class="fas fa-hourglass-end"></i> F√©rias a expirar</h2>
      <div id="expiring-vacations-list" class="team-container"></div>
    </section>
  </div>

  <footer>
    AW;Code 2025 - Todos os direitos reservados | <a href="mailto:contato@bagam.com" style="color:#fff;text-decoration:underline;">Contato</a>
    <img src="Fotos Colaboradores/logo2.png" width="70" height="80">
  </footer>
  <script>

    // Todos os colaboradores mantidos e exemplo de conflito
    const collaborators = [
  {name:"AGEILSON",setor:"Opera√ß√£o",photo:"Fotos Colaboradores/ageilson.png",vacations:[
    {start:"13/01/2025",end:"01/02/2025"},
    {start:"12/01/2026",end:"31/01/2026"}
  ],birthday:"27/08"},
  {name:"ALLAN",setor:"Opera√ß√£o",photo:"Fotos Colaboradores/allan.png",vacations:[
    {start:"29/05/2025",end:"12/06/2025"},
    {start:"20/10/2025",end:"08/11/2025"}
  ],birthday:"12/06"},
  {name:"ALDERIR",setor:"Pintura",photo:"Fotos Colaboradores/alderir.jpeg",vacations:[],birthday:"04/02"},
  {name:"ANA CL√âZIA",setor:"CCO",photo:"Fotos Colaboradores/ana.jpeg",vacations:[],birthday:"20/11"},
  {name:"AUGUSTO",setor:"Manuten√ß√£o",photo:"Fotos Colaboradores/augusto.png",vacations:[],birthday:"25/05"},
  {name:"CLEIRTON",setor:"Ger√™ncia",photo:"Fotos Colaboradores/cleirton.png",vacations:[
    {start:"03/11/2025",end:"17/11/2025"},
    {start:"23/02/2025",end:"27/02/2025"}
  ],birthday:"12/05"},
  {name:"CRISTIANO",setor:"Opera√ß√£o",photo:"Fotos Colaboradores/cristiano.png",vacations:[
    {start:"14/04/2025",end:"03/05/2025"}
  ],birthday:"15/04"},
  {name:"DANIEL",setor:"Conserva√ß√£o",photo:"Fotos Colaboradores/daniel.png",vacations:[],birthday:"26/08"},
  {name:"DANILO",setor:"Laborat√≥rio",photo:"Fotos Colaboradores/danilo.png",vacations:[],birthday:"12/10"},
  {name:"DOUGLAS",setor:"Opera√ß√£o",photo:"Fotos Colaboradores/douglas.jpeg",vacations:[],birthday:"23/12"},
  {name:"EDNILMA",setor:"Conserva√ß√£o",photo:"Fotos Colaboradores/nenem.jpg",vacations:[],birthday:"26/08"},
  {name:"EDUARDO",setor:"Lideran√ßa",photo:"Fotos Colaboradores/eduardo.png",vacations:[
    {start:"05/03/2025",end:"09/03/2025"}
  ],birthday:"16/03"},
  {name:"ELTOM",setor:"Opera√ß√£o",photo:"Fotos Colaboradores/eltom.png",vacations:[
    {start:"16/06/2025",end:"06/07/2025"}
  ],birthday:"11/08"},
  {name:"NALDO",setor:"Opera√ß√£o",photo:"Fotos Colaboradores/naldo.png",vacations:[
   {start:"19/02/2025",end:"05/03/2025"}
  ],birthday:"28/10"},
  {name:"GABRIEL",setor:"Vigil√¢ncia",photo:"Fotos Colaboradores/gabriel.png",vacations:[],birthday:"25/03"},
  {name:"GEDSON",setor:"Opera√ß√£o",photo:"Fotos Colaboradores/gedson.png",vacations:[
    {start:"04/08/2025",end:"02/09/2025"}
  ],birthday:"03/06"},
  {name:"GLEISON",setor:"Opera√ß√£o",photo:"Fotos Colaboradores/gleison.png",vacations:[
    {start:"15/09/2025",end:"29/09/2025"},
    {start:"17/11/2025",end:"01/12/2025"}
  ],birthday:"06/07"},
  {name:"HELINE",setor:"Administrativo",photo:"Fotos Colaboradores/heline.png",vacations:[
    {start:"24/02/2025",end:"28/02/2025"}
  ],birthday:"06/11"},
  {name:"HILANA",setor:"CCO",photo:"Fotos Colaboradores/hilana.png",vacations:[
    {start:"24/02/2025",end:"28/02/2025"}
  ],birthday:"24/06"},
  {name:"ISAIAS",setor:"Opera√ß√£o",photo:"Fotos Colaboradores/isaias.png",vacations:[],birthday:"29/03"},
  {name:"JO√ÉO VITOR",setor:"CCO",photo:"Fotos Colaboradores/joao.png",vacations:[
    {start:"23/01/2025",end:"06/02/2025"}
  ],birthday:"12/05"},
  {name:"JUNIOR",setor:"Manuten√ß√£o",photo:"Fotos Colaboradores/junior.jpeg",vacations:[],birthday:"16/11"},
  {name:"JULLY",setor:"Opera√ß√£o",photo:"Fotos Colaboradores/jully.png",vacations:[
    {start:"02/12/2025",end:"31/12/2025"}
  ],birthday:"23/09"},
  {name:"LEANDRO",setor:"Vigil√¢ncia",photo:"Fotos Colaboradores/leandro.jpeg",vacations:[],birthday:"25/02"},
  {name:"MARIA CLAUDIA",setor:"Administrativo",photo:"Fotos Colaboradores/claudia.jpg",vacations:[],birthday:"27/10"},
  {name:"NAILSON",setor:"Vigil√¢ncia",photo:"Fotos Colaboradores/nailson.png",vacations:[],birthday:"03/11"},
  {name:"PETERSON",setor:"Laborat√≥rio",photo:"Fotos Colaboradores/peterson.png",vacations:[
    {start:"24/02/2025",end:"28/02/2025"}
  ],birthday:"10/08"},
  {name:"RONILSON",setor:"Opera√ß√£o",photo:"Fotos Colaboradores/ronilson.png",vacations:[
    {start:"10/03/2025",end:"08/04/2025"}
  ],birthday:"08/12"},
  {name:"SAMUEL",setor:"Conserva√ß√£o",photo:"Fotos Colaboradores/samuel.jpg",vacations:[],birthday:"28/08"},
  {name:"VALMIR",setor:"Vigil√¢ncia",photo:"Fotos Colaboradores/valmir.jpg",vacations:[],birthday:"02/01"},
  {name:"VLADIMIR",setor:"Pintura",photo:"Fotos Colaboradores/vlad.jpg",vacations:[],birthday:"17/02"},
  {name:"WAGNER",setor:"CCO",photo:"Fotos Colaboradores/wagner.png",vacations:[
    {start:"02/01/2025",end:"20/01/2025"},
    {start:"20/05/2025",end:"24/05/2025"},
    {start:"02/01/2026",end:"20/01/2026"}
  ],birthday:"10/05"},
  {name:"WENDERSON",setor:"TI",photo:"Fotos Colaboradores/wenderson.png",vacations:[],birthday:"08/08"},
  {name:"WILLIAM",setor:"SMS",photo:"Fotos Colaboradores/william.png",vacations:[
    // 1¬∫ per√≠odo n√£o informado (xxxxx)
    {start:"24/06/2025",end:"28/06/2025"},
    {start:"19/08/2025",end:"01/09/2025"}
  ],birthday:"01/04"}
];

// Fun√ß√£o para obter colaboradores com f√©rias a expirar (11 meses sem f√©rias)
function getExpiringVacations(collaborators, selectedMonth, selectedYear) {
  // Considera o √∫ltimo dia do m√™s/ano selecionado como refer√™ncia
  const now = new Date(selectedYear, selectedMonth + 1, 0);
  const thresholdDays = 330; // 11 meses
  return collaborators.filter(colab => {
    if (!Array.isArray(colab.vacations) || colab.vacations.length === 0) return true; // Nunca tirou f√©rias
    // Pega o √∫ltimo per√≠odo de f√©rias registrado
    const lastVacation = colab.vacations.reduce((latest, v) => {
      const end = parseDateBR(v.end);
      return (!latest || (end && end > parseDateBR(latest.end))) ? v : latest;
    }, null);
    if (!lastVacation || !lastVacation.end) return true;
    const lastEnd = parseDateBR(lastVacation.end);
    if (!lastEnd) return true;
    const diffDays = Math.floor((now - lastEnd) / (1000 * 60 * 60 * 24));
    return diffDays >= thresholdDays;
  });
}

    // Adiciona alerta visual na lista de colaboradores com f√©rias a expirar
    function renderExpiringVacationsList(list, container) {
      container.innerHTML = list.length ? list.map(colab => {
        const photoUrl = colab.photo || "https://via.placeholder.com/120x120?text=Colaborador";
        let lastVacationText = "Nunca tirou f√©rias";
        if (Array.isArray(colab.vacations) && colab.vacations.length > 0) {
          const lastVacation = colab.vacations.reduce((latest, v) => {
            const end = parseDateBR(v.end);
            return (!latest || (end && end > parseDateBR(latest.end))) ? v : latest;
          }, null);
          if (lastVacation && lastVacation.end) {
            lastVacationText = `√öltimo per√≠odo: ${formatDateBR(lastVacation.start)} a ${formatDateBR(lastVacation.end)}`;
          }
        }
        return `<div class="member-card" style="border-color:#d81c1c;">
          <i class="fas fa-user"></i>
          <img src="${photoUrl}" alt="${colab.name}" class="member-photo"/>
          <h3>${colab.name}</h3>
          <p><strong><i class="fas fa-building"></i> Setor:</strong> ${colab.setor || "N/D"}</p>
          <p><i class="fas fa-hourglass-end" style="color:#d81c1c;"></i> <span style="color:#d81c1c;font-weight:bold;">F√©rias a expirar!</span></p>
          <p>${lastVacationText}</p>
          <p style="color:#d81c1c;font-size:0.98rem;"><i class="fas fa-exclamation-triangle"></i> Marque suas f√©rias o quanto antes!</p>
        </div>`;
      }).join("") : "<p>Nenhum colaborador com f√©rias a expirar.</p>";
    }

// Feriados municipais e estaduais espec√≠ficos de Guamar√©/RN
const localHolidays = [
      { day: 20, month: 0, year: 2025, name: "S√£o Sebasti√£o ‚Äì Municipal" },
      { day: 7, month: 4, year: 2025, name: "Emancipa√ß√£o Pol√≠tica de Guamar√© ‚Äì Municipal" },
      { day: 15, month: 7, year: 2025, name: "Nossa Senhora dos Navegantes ‚Äì Municipal" },
      { day: 3, month: 9, year: 2025, name: "Mem√≥ria Dos Protom√°rtires de Urua√ßu e Cunha√∫ ‚Äì Estadual (RN)" },
      { day: 8, month: 11, year: 2025, name: "Nossa Senhora da Concei√ß√£o ‚Äì Municipal" }
    ];
    function getLocalHoliday(day, month, year) {
      return localHolidays.find(h => h.day === day && h.month === month && h.year === year);
    }
    const holidays = [
      { day: 1, month: 0, name: "Confraterniza√ß√£o Universal" },
      { day: 25, month: 1, name: "Carnaval" },
      { day: 29, month: 2, name: "Paix√£o de Cristo" },
      { day: 21, month: 3, name: "Tiradentes" },
      { day: 1, month: 4, name: "Dia do Trabalho" },
      { day: 7, month: 8, name: "Independ√™ncia do Brasil" },
      { day: 12, month: 9, name: "Nossa Senhora Aparecida" },
      { day: 2, month: 10, name: "Finados" },
      { day: 15, month: 10, name: "Proclama√ß√£o da Rep√∫blica" },
      { day: 20, month: 10, name: "Consci√™ncia Negra" },
      { day: 25, month: 11, name: "Natal" }
    ];
    const monthNames = [
      "Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"
    ];
    function parseDateBR(str) {
      if (!str) return null;
      str = str.replace(/-/g, '/');
      const p = str.split('/');
      if (p.length < 3) return null;
      let d, m, y;
      if (p[0].length === 4) { y = p[0], m = p[1], d = p[2]; }
      else { d = p[0], m = p[1], y = p[2]; }
      return new Date(+y, +m-1, +d);
    }
    function formatDateBR(str) {
      if (!str) return "";
      str = str.replace(/-/g, '/');
      const p = str.split('/');
      let d, m, y;
      if (p.length < 2) return "";
      if (p.length === 2) { d = p[0], m = p[1], y = null; }
      else if (p[0].length === 4) { y = p[0], m = p[1], d = p[2]; }
      else { d = p[0], m = p[1], y = p[2]; }
      d = d.padStart(2,"0"); m = m.padStart(2,"0");
      if (y) { if (y.length === 2) y = '20'+y; return `${d}/${m}/${y}`; }
      return `${d}/${m}`;
    }
    function getBirthdayMonth(str) {
      if (!str) return null;
      str = str.replace(/-/g, '/');
      const p = str.split('/');
      return p[1]?parseInt(p[1],10)-1:null;
    }
    function getBirthdayDay(str) {
      if (!str) return null;
      str = str.replace(/-/g, '/');
      const p = str.split('/');
      return p[0]?parseInt(p[0],10):null;
    }
    // Checa se QUALQUER per√≠odo de f√©rias do colaborador est√° no m√™s/ano
    function isOnVacationInMonth(vacations, month, year) {
      if (!Array.isArray(vacations)) return false;
      return vacations.some(v => {
        if (!v?.start || !v?.end) return false;
        const s = parseDateBR(v.start), e = parseDateBR(v.end);
        if (!s || !e) return false;
        return (s.getFullYear() < year || (s.getFullYear() === year && s.getMonth() <= month)) &&
               (e.getFullYear() > year || (e.getFullYear() === year && e.getMonth() >= month));
      });
    }
    // Checa se h√° sobreposi√ß√£o entre QUALQUER per√≠odo de f√©rias de dois colaboradores
    function isVacationOverlap(aVac, bVac) {
      if (!Array.isArray(aVac) || !Array.isArray(bVac)) return false;
      return aVac.some(a => bVac.some(b => {
        if (!a?.start || !a?.end || !b?.start || !b?.end) return false;
        const aS = parseDateBR(a.start), aE = parseDateBR(a.end),
              bS = parseDateBR(b.start), bE = parseDateBR(b.end);
        if (!aS || !aE || !bS || !bE) return false;
        return aS <= bE && aE >= bS;
      }));
    }
    function findVacationConflicts(list, month, year) {
      const inMonth = list.filter(c => isOnVacationInMonth(c.vacations, month, year));
      const set = new Set;
      for (let i = 0; i < inMonth.length; i++)
        for (let j = i + 1; j < inMonth.length; j++)
          if (isVacationOverlap(inMonth[i].vacations, inMonth[j].vacations)) {
            set.add(inMonth[i].name);
            set.add(inMonth[j].name);
          }
      return set;
    }
    function findVacationSectorConflicts(list, month, year) {
      const inMonth = list.filter(c => isOnVacationInMonth(c.vacations, month, year));
      const setorMap = {}, set = new Set;
      inMonth.forEach(c => {
        if (!setorMap[c.setor]) setorMap[c.setor] = [];
        setorMap[c.setor].push(c);
      });
      Object.values(setorMap).forEach(arr => {
        for (let i = 0; i < arr.length; i++)
          for (let j = i + 1; j < arr.length; j++)
            if (isVacationOverlap(arr[i].vacations, arr[j].vacations)) {
              set.add(arr[i].name);
              set.add(arr[j].name);
            }
      });
      return set;
    }
    const monthSelect = document.getElementById("month-select"), yearSelect = document.getElementById("year-select");
    for(let i=0;i<12;i++){const opt=document.createElement("option");opt.value=i;opt.textContent=monthNames[i];monthSelect.appendChild(opt);}
    const currentYear = new Date().getFullYear();
    for(let y=currentYear;y<=currentYear+2;y++){const opt=document.createElement("option");opt.value=y;opt.textContent=y;yearSelect.appendChild(opt);}
    let selectedMonth = new Date().getMonth(), selectedYear = new Date().getFullYear();
    monthSelect.value = selectedMonth; yearSelect.value = selectedYear;
    document.getElementById("prev-month").onclick=()=>{selectedMonth--;if(selectedMonth<0){selectedMonth=11;selectedYear--;}updateAll();};
    document.getElementById("next-month").onclick=()=>{selectedMonth++;if(selectedMonth>11){selectedMonth=0;selectedYear++;}updateAll();};
    monthSelect.onchange=e=>{selectedMonth=parseInt(monthSelect.value,10);updateAll();};
    yearSelect.onchange=e=>{selectedYear=parseInt(yearSelect.value,10);updateAll();};
    function renderCalendar() {
      const calendarTitle = document.getElementById("calendar-title"), calendarGrid = document.getElementById("calendar-grid");
      calendarTitle.textContent=`${monthNames[selectedMonth]} ${selectedYear}`; calendarGrid.innerHTML="";
      ["Dom","Seg","Ter","Qua","Qui","Sex","S√°b"].forEach(day=>{
        const h=document.createElement("div");
        h.className="calendar-day header";
        h.textContent=day;
        calendarGrid.appendChild(h);
      });
      const firstDay=new Date(selectedYear,selectedMonth,1).getDay(),daysInMonth=new Date(selectedYear,selectedMonth+1,0).getDate(),
        birthdays=collaborators.filter(c=>getBirthdayMonth(c.birthday)===selectedMonth),
        birthdayDays=birthdays.map(b=>getBirthdayDay(b.birthday));
      const holidaysInMonth = holidays.filter(h => h.month === selectedMonth);
      for(let i=0;i<firstDay;i++){
        const e=document.createElement("div");
        e.className="calendar-day empty";
        calendarGrid.appendChild(e);
      }
      for(let day=1;day<=daysInMonth;day++){
        const d=document.createElement("div");
        d.className = "calendar-day";
        d.textContent = day;
        const holiday = holidaysInMonth.find(h=>h.day===day);
        const localHoliday = getLocalHoliday(day, selectedMonth, selectedYear);
        const isBirthday = birthdayDays.includes(day);
        if ((holiday || localHoliday) && isBirthday) {
          d.classList.add("conflict-event");
          let tooltipText = "";
          let holidayIcon = "";
          if (localHoliday) {
            d.classList.add("local-holiday");
            tooltipText = `Anivers√°rio: ${birthdays.filter(b=>getBirthdayDay(b.birthday)===day).map(b=>b.name).join(", ")}<br>Feriado municipal: ${localHoliday.name}`;
          } else {
            tooltipText = `Anivers√°rio: ${birthdays.filter(b=>getBirthdayDay(b.birthday)===day).map(b=>b.name).join(", ")}<br>Feriado nacional: ${ holiday.name }`;
            holidayIcon = `<i class="fa-solid fa-calendar-day"></i>`;
          }
          d.innerHTML = `
            <span style="position: relative;">${day}</span>
            <i class="fa-solid fa-birthday-cake"></i>
            ${holidayIcon}
            <div class="calendar-tooltip">${tooltipText}</div> 
          `;
        }
        else if (localHoliday) {
          d.classList.add("local-holiday");
          d.innerHTML = day +
            `<div class="calendar-tooltip">${localHoliday.name}</div>`;
        }
        else if (holiday) {
          d.className += " holiday";
          d.innerHTML = day +
            `<div class="calendar-tooltip">${holiday.name}</div>`;
        }
        else if (isBirthday) {
          d.className += " birthday";
          const names = birthdays.filter(b=>getBirthdayDay(b.birthday)===day).map(b=>b.name).join(", ");
          d.innerHTML = day +
            `<div class="calendar-tooltip">Anivers√°rio: ${names}</div>`;
        }
        const isToday = 
          day === new Date().getDate() &&
          selectedMonth === new Date().getMonth() &&
          selectedYear === new Date().getFullYear();
        if (isToday) {
          d.classList.add("today");
          if (d.innerHTML.includes('calendar-tooltip')) {
            // Se j√° tem tooltip, s√≥ adiciona estrela
            //d.innerHTML += `<i class="fa-solid fa-star" style="position:absolute;left:5px;bottom:5px;color:#ffeb3b;font-size:1.1em;"></i>`;
          } else {
           // d.innerHTML = `<span style="position: relative;">${day}</span><i class="fa-solid fa-star" style="position:absolute;left:5px;bottom:5px;color:#ffeb3b;font-size:1.1em;"></i>`;
          }
        }
        calendarGrid.appendChild(d);
      }
    }
    function renderCollaboratorList(list,container,showVacation,showBirthday,conflicts,sectorConflicts){
  const today = new Date();
  const showTodayHighlight = selectedMonth === today.getMonth() && selectedYear === today.getFullYear();
  container.innerHTML = list.length ? list.map(colab => {
    const photoUrl = colab.photo || "https://via.placeholder.com/120x120?text=Colaborador";
    const isBirthdayToday = showBirthday && colab.birthday &&
      getBirthdayMonth(colab.birthday) === today.getMonth() &&
      getBirthdayDay(colab.birthday) === today.getDate() &&
      showTodayHighlight;
    return `<div class="member-card${isBirthdayToday ? ' birthday-today' : ''}">
      <i class="fas fa-user"></i>
      <img src="${photoUrl}" alt="${colab.name}" class="member-photo"/>
      <h3>${colab.name}</h3>
      <p><strong><i class="fas fa-building"></i> Setor:</strong> ${colab.setor || "N/D"}</p>
      ${
        showVacation && Array.isArray(colab.vacations)
          ? colab.vacations.map((v, idx) =>
`<p><i class="fas fa-plane-departure"></i> <strong>${idx+1}¬∫ per√≠odo:</strong> ${formatDateBR(v.start)} a ${formatDateBR(v.end)}</p>`
).join("")
          : ""
      }
      ${
        sectorConflicts && sectorConflicts.has(colab.name)
          ? `<p class="conflict" style="background:#ffefc7;color:#856404;border-color:#ffc107;"><i class="fas fa-exclamation-triangle"></i> Alerta: Conflito de f√©rias no setor!</p>`
          : ""
      }
      ${
        showBirthday && colab.birthday
          ? `<p><i class="fas fa-birthday-cake"></i> Anivers√°rio: ${formatDateBR(colab.birthday)}</p>`
          : ""
      }
    </div>`;
  }).join("") : "<p>Nenhum colaborador encontrado.</p>";
}
  //quiser voltar depois apaga aqui pra ficar em loop os emojis embaixo essa fun√ß√£o (tem q descomentar os loops)
function setupBirthdayCardConfetti() {
  // Remove qualquer loop anterior
  stopConfettiLoop();
  // Seleciona todos os cards de anivers√°rio do dia
  document.querySelectorAll('.member-card.birthday-today').forEach(card => {
    let confettiTimer = null;
    card.addEventListener('mouseenter', () => {
      // Inicia confete em loop enquanto mouse est√° sobre o card
      createConfettiBurst(card, 15); // burst inicial
      confettiTimer = setInterval(() => createConfettiBurst(card, 10), 700);
      card._confettiTimer = confettiTimer;
    });
    card.addEventListener('mouseleave', () => {
      // Para o loop ao sair do card
      if (card._confettiTimer) clearInterval(card._confettiTimer);
      card._confettiTimer = null;
    });
  });
}

/* cria confetes dentro de cada card com classe .birthday-today */
let _confettiLoopTimer = null;

function createConfettiBurst(card, count = 18) {
  const emojis = ['üéâ','ü•≥','üëè'];
  const rect = card.getBoundingClientRect();
  const cx = rect.width / 2;
  const cy = rect.height / 2;

  for (let i = 0; i < count; i++) {
    const el = document.createElement('span');
    el.className = 'confetti';
    el.textContent = emojis[Math.floor(Math.random() * emojis.length)];

    // tamanho do emoji (mais variado mas suave)
    const emSize = 16 + Math.floor(Math.random() * 14); // 16..29px
    el.style.setProperty('--em-size', emSize + 'px');

    // posiciona no centro para explos√£o interna
    el.style.left = (cx - emSize / 2) + 'px';
    el.style.top = (cy - emSize / 2) + 'px';

    // dire√ß√£o radial aleat√≥ria
    const angle = Math.random() * Math.PI * 2;
    // dist√¢ncia final menor e mais controlada para suavidade
    const base = Math.max(rect.width, rect.height);
    const distance = 40 + Math.random() * (base * 0.55); // menor spread

    // vento sutil e bias de gravidade reduzido
    const wind = (Math.random() * 60 - 30); // -30..30
    const gravityBias = 24 + Math.random() * 28; // menos queda brusca

    const dx = Math.cos(angle) * distance + wind * 0.2;
    const dy = Math.sin(angle) * distance + gravityBias;

    el.style.setProperty('--dx', Math.round(dx) + 'px');
    el.style.setProperty('--dy', Math.round(dy) + 'px');

    // N√ÉO aplicar rota√ß√£o: removido --rot para efeito sem giro

    // dura√ß√£o e delay suaves (estagger pequeno)
    const dur = (1100 + Math.random() * 700).toFixed(0) + 'ms'; // 1100..1800ms
    const delay = Math.floor(Math.random() * 140); // 0..140ms
    el.style.setProperty('--dur', dur);
    el.style.setProperty('--delay', delay + 'ms');

    // opacidade inicial consistente para suavidade
    el.style.opacity = 0.92;

    card.appendChild(el);

    // remove depois da anima√ß√£o terminar
    const removeAfter = parseInt(dur, 10) + parseInt(delay, 10) + 300;
    setTimeout(() => { if (el && el.parentNode) el.parentNode.removeChild(el); }, removeAfter);
  }
}

function startConfettiLoop() {
  stopConfettiLoop(); // evita timers duplicados
  const cards = document.querySelectorAll('.member-card.birthday-today');
  if (!cards.length) return;
  cards.forEach(c => createConfettiBurst(c, 15)); // burst inicial
  _confettiLoopTimer = setInterval(() => {
    const current = document.querySelectorAll('.member-card.birthday-today');
    if (!current.length) { stopConfettiLoop(); return; }
    current.forEach(c => createConfettiBurst(c, 10));
  }, 700);
}

function stopConfettiLoop() {
  if (_confettiLoopTimer) {
    clearInterval(_confettiLoopTimer);
    _confettiLoopTimer = null;
  }
}

/* compatibilidade: chamada usada pelo updateAll() */
function launchConfettiOnBirthdayCards() {
  //startConfettiLoop();
}
    
    function updateAll(){
  //stopConfettiLoop(); // <--- evita m√∫ltiplos timers quando trocar m√™s/ano
  renderCalendar();
  const vacationList = collaborators.filter(c=>isOnVacationInMonth(c.vacations,selectedMonth,selectedYear)),
        birthdayList = collaborators.filter(c=>getBirthdayMonth(c.birthday)===selectedMonth),
        conflicts = findVacationConflicts(collaborators,selectedMonth,selectedYear),
        sectorConflicts = findVacationSectorConflicts(collaborators,selectedMonth,selectedYear),
        expiringList = getExpiringVacations(collaborators, selectedMonth, selectedYear); // <-- ADICIONADO
  renderCollaboratorList(vacationList,document.getElementById("vacation-list"),true,false,conflicts,sectorConflicts);
  renderCollaboratorList(birthdayList,document.getElementById("birthday-list"),false,true,null,sectorConflicts);
  renderCollaboratorList(collaborators.sort((a,b)=>a.name.localeCompare(b.name,'pt-BR')),document.getElementById("team-list"),true,true,conflicts,sectorConflicts);
  renderExpiringVacationsList(expiringList, document.getElementById("expiring-vacations-list")); // <-- ADICIONADO

  // espera DOM renderizar e inicia confete em loop se houver anivers√°rios hoje
  setTimeout(launchConfettiOnBirthdayCards, 200);

  //quiser voltar depois apaga aqui pra ficar em loop os emojis
  renderCollaboratorList(collaborators.sort((a,b)=>a.name.localeCompare(b.name,'pt-BR')),document.getElementById("team-list"),true,true,conflicts,sectorConflicts);
  // Adiciona eventos de mouse nos cards de anivers√°rio do dia
  setupBirthdayCardConfetti();
}

// Preenche setores √∫nicos no filtro
function preencherSetoresFiltro() {
  const setores = [...new Set(collaborators.map(c => c.setor).filter(Boolean))].sort();
  const select = document.getElementById('filter-setor');
  select.innerHTML = '<option value="">Todos</option>' + setores.map(s => `<option value="${s}">${s}</option>`).join('');
}

// Mostra/esconde painel de filtro
document.getElementById('filter-btn').onclick = function() {
  preencherSetoresFiltro();
  document.getElementById('filter-panel').style.display = 'block';
};
document.getElementById('filter-fechar').onclick = function() {
  document.getElementById('filter-panel').style.display = 'none';
  document.getElementById('filter-resultado').innerHTML = '';
};

// Adiciona aviso de filtro ativo e bot√£o para limpar
function mostrarAvisoFiltro(filtrados) {
  let aviso = document.getElementById('aviso-filtro');
  if (!aviso) {
    aviso = document.createElement('div');
    aviso.id = 'aviso-filtro';
    aviso.style.position = 'fixed';
    aviso.style.top = '70px';
    aviso.style.left = '50%';
    aviso.style.transform = 'translateX(-50%)';
    aviso.style.background = '#047562';
    aviso.style.color = '#fff';
    aviso.style.padding = '12px 28px';
    aviso.style.borderRadius = '10px';
    aviso.style.boxShadow = '0 2px 12px #0002';
    aviso.style.zIndex = '3000';
    aviso.style.fontWeight = 'bold';
    aviso.style.fontSize = '1.12rem';
    aviso.style.display = 'flex';
    aviso.style.alignItems = 'center';
    aviso.style.gap = '18px';
    aviso.innerHTML = `<span><i class="fas fa-filter"></i> Filtro ativo (${filtrados.length} colaborador${filtrados.length===1?'':'es'})</span>
      <button id="btn-limpar-filtro" class="btn btn-outline-light btn-sm" style="font-weight:600;"><i class="fas fa-undo"></i> Limpar filtro</button>`;
    document.body.appendChild(aviso);
    document.getElementById('btn-limpar-filtro').onclick = function() {
      limparFiltro();
    };
  } else {
    aviso.querySelector('span').innerHTML = `<i class="fas fa-filter"></i> Filtro ativo (${filtrados.length} colaborador${filtrados.length===1?'':'es'})`;
  }
  aviso.style.display = 'flex';
}

function esconderAvisoFiltro() {
  const aviso = document.getElementById('aviso-filtro');
  if (aviso) aviso.style.display = 'none';
}

// Fun√ß√£o para limpar filtro e restaurar lista completa
function limparFiltro() {
  document.getElementById('filter-setor').value = '';
  document.getElementById('filter-nome').value = '';
  document.getElementById('filter-aniversario').value = '';
  document.getElementById('filter-ferias').checked = false;
  esconderAvisoFiltro();
  updateAll();
  document.getElementById('filter-panel').style.display = 'none';
  document.getElementById('filter-resultado').innerHTML = '';
}

// Filtra e mostra resultado em todos os pain√©is
document.getElementById('filter-aplicar').onclick = function() {
  const setor = document.getElementById('filter-setor').value.trim();
  const nome = document.getElementById('filter-nome').value.trim().toLowerCase();
  const aniversario = document.getElementById('filter-aniversario').value.trim();
  const soFerias = document.getElementById('filter-ferias').checked;

  let filtrados = collaborators.filter(c => {
    let ok = true;
    if (setor) ok = ok && c.setor === setor;
    if (nome) ok = ok && c.name.toLowerCase().includes(nome);
    if (aniversario) ok = ok && c.birthday && formatDateBR(c.birthday).startsWith(aniversario);
    if (soFerias) ok = ok && isOnVacationInMonth(c.vacations, selectedMonth, selectedYear);
    return ok;
  });

  // Atualiza todos os campos com os colaboradores filtrados
  const vacationList = filtrados.filter(c=>isOnVacationInMonth(c.vacations,selectedMonth,selectedYear));
  const birthdayList = filtrados.filter(c=>getBirthdayMonth(c.birthday)===selectedMonth);
  const conflicts = findVacationConflicts(filtrados,selectedMonth,selectedYear);
  const sectorConflicts = findVacationSectorConflicts(filtrados,selectedMonth,selectedYear);
  const expiringList = getExpiringVacations(filtrados, selectedMonth, selectedYear);

  renderCollaboratorList(vacationList,document.getElementById("vacation-list"),true,false,conflicts,sectorConflicts);
  renderCollaboratorList(birthdayList,document.getElementById("birthday-list"),false,true,null,sectorConflicts);
  renderCollaboratorList(filtrados.sort((a,b)=>a.name.localeCompare(b.name,'pt-BR')),document.getElementById("team-list"),true,true,conflicts,sectorConflicts);
  renderExpiringVacationsList(expiringList, document.getElementById("expiring-vacations-list"));

  setupBirthdayCardConfetti();

  // Fecha o painel de filtro ap√≥s aplicar
  document.getElementById('filter-panel').style.display = 'none';
  document.getElementById('filter-resultado').innerHTML = '';

  // Mostra aviso de filtro ativo
  mostrarAvisoFiltro(filtrados);

  // Leva o usu√°rio at√© o painel de colaboradores filtrados
  document.getElementById('team-list-section').scrollIntoView({ behavior: 'smooth' });
};

// Limpar filtro tamb√©m pelo bot√£o do painel
document.getElementById('filter-limpar').onclick = function() {
  limparFiltro();
};
    updateAll();
    document.getElementById("toggleDark")?.addEventListener("click",function(){
      document.body.classList.toggle("dark-mode");
      document.querySelector("footer").classList.toggle("dark-mode");
      document.querySelector(".container").classList.toggle("dark-mode");
    });
    
function showNotification(msg, icon = "fa-info-circle", color = "#047562") {
  // Cria um ID √∫nico para cada notifica√ß√£o
  const notifId = 'auto-notification-' + Math.random().toString(36).substr(2, 6);
  const notif = document.createElement('div');
  notif.id = notifId;
  notif.style.position = 'fixed';
  notif.style.top = '18px';
  notif.style.left = '50%';
  notif.style.transform = 'translateX(-50%)';
  notif.style.background = color;
  notif.style.color = '#fff';
  notif.style.padding = '13px 32px';
  notif.style.borderRadius = '12px';
  notif.style.boxShadow = '0 2px 16px #0002';
  notif.style.zIndex = '4000';
  notif.style.fontWeight = 'bold';
  notif.style.fontSize = '1.13rem';
  notif.style.display = 'flex';
  notif.style.alignItems = 'center';
  notif.style.gap = '16px';
  notif.innerHTML = `<i class="fas ${icon}" style="font-size:1.3em;"></i> <span>${msg}</span>
    <button id="close-notif-${notifId}" class="btn btn-outline-light btn-sm" style="margin-left:18px;"><i class="fas fa-times"></i></button>`;
  document.body.appendChild(notif);
  document.getElementById(`close-notif-${notifId}`).onclick = function() {
    if (notif) notif.remove();
  };
  // Fecha automaticamente ap√≥s 12 segundos
  setTimeout(() => {
    if (document.getElementById(notifId)) {
      notif.style.display = 'none';
      notif.remove();
    }
  }, 12000);
}

// Chama notifica√ß√µes autom√°ticas ao abrir
function checkAutoNotifications() {
  const today = new Date();
  const todayMonth = today.getMonth();
  const todayDay = today.getDate();

  // Aniversariantes do dia
  const aniversariantesHoje = collaborators.filter(c =>
    getBirthdayMonth(c.birthday) === todayMonth &&
    getBirthdayDay(c.birthday) === todayDay
  );
  if (aniversariantesHoje.length) {
    showNotification(
      `Hoje √© anivers√°rio de: ${aniversariantesHoje.map(c=>c.name).join(', ')}`,
      "fa-birthday-cake",
      "#ef6c00"
    );
  }

  // F√©rias a expirar
  const expiring = getExpiringVacations(collaborators, todayMonth, today.getFullYear());
  if (expiring.length) {
    showNotification(
      `Aten√ß√£o: ${expiring.length} colaborador${expiring.length===1?'':'es'} com f√©rias a expirar!`,
      "fa-hourglass-end",
      "#d81c1c"
    );
  }
}
checkAutoNotifications();
updateAll();
  </script>
</body>
</html>












